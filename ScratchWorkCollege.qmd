---
title: "College Scratch"
author: "Corbin B; Matthew W"
format: pdf
editor: visual
---

```{r}

library(tidyverse)

```

```{r}

sal_df <- vroom::vroom("Salary.csv")

sal_df <- sal_df |>
  mutate(
    MajorCategory = factor(MajorCategory),
    Sex = factor(Sex)
  )

sal_lm<-lm(Salary~ .,sal_df)
sal_lm_int_GPA_MAJ  <- lm(Salary ~ GPA * MajorCategory + Sex, data = sal_df)

head(sal_df)
```

## Impact of GPA - Corbin

### What impact, if any, does GPA have on salary? Do you think students should be hyper-anxious about grades?

```{r}


# 1) Pull GPA beta (estimate) and p-value from the summary object
smry <- summary(sal_lm)
coef_mat <- smry$coefficients

gpa_estimate <- coef_mat["GPA", "Estimate"]
gpa_pvalue   <- coef_mat["GPA", "Pr(>|t|)"]

# 2) Confidence interval (default 95%)
gpa_ci <- confint(sal_lm, "GPA", level = 0.95)

# Print nicely
cat("GPA beta (Estimate):", round(gpa_estimate, 4), "\n")
cat("GPA p-value        :", signif(gpa_pvalue, 4), "\n")
cat("GPA 95% CI         : [",
    round(gpa_ci[1], 4), ", ", round(gpa_ci[2], 4), "]\n", sep = "")


```

### Is the effect of GPA different for different majors (does GPA matter more for some majors than others)?. -Corbin

```{r}

# Recommended contrasts for Type III tests
options(contrasts = c("contr.sum", "contr.poly"))
library(car)
car::Anova(sal_lm_int_GPA_MAJ, type = 3)
```

## Salaries Across Majors - Matthew

```{r}

# linear model predicting Salary by Major Category
maj_lm <- lm(Salary ~ MajorCategory, data = sal_df)
summary(maj_lm)


```

Yes, we see that "Engineering", "Computers and Mathematics", and "Physical Sciences" make the most when ignoring all other varaibles.

## Salaries for Women and Men - Corbin

```{r}
sal_lm_sex_major <- lm(
  Salary ~ GPA + Sex * MajorCategory,
  data = sal_df
)

summary(sal_lm_sex_major)

```

## Other Factors - Matthew

```{r}

# linear model using all predictors and no interactions
sal_lm<-lm(Salary~ .,sal_df)

# linear model using all predictors and interactions found to be significant:
sal_interaction_lm <- lm(Salary ~ MajorCategory * Sex + MajorCategory * GPA, data = sal_df)


anova(sal_lm, sal_interaction_lm)
summary(sal_interaction_lm)



```
